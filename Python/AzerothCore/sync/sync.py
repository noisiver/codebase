import colorama
import git
import hashlib
import os
import pymysql
import subprocess

if os.name == 'nt':
    colorama.just_fix_windows_console()

mysql = {
    'host': '127.0.0.1',
    'port': 3306,
    'username': 'acore',
    'password': 'acore',
    'database': 'progression_world',
    'base': 'base_world'
}

windows_paths = {
    'mysql': 'C:/Program Files/MySQL/MySQL Server 8.4'
}

# table name, type (min/max or patch), add column(s) after this column, primary keys with new columns, delete queries before inserts
tables = [
    [
        'conditions',
        0,
        'Comment',
        '`SourceTypeOrReferenceId`, `SourceGroup`, `SourceEntry`, `SourceId`, `ElseGroup`, `ConditionTypeOrReference`, `ConditionTarget`, `ConditionValue1`, `ConditionValue2`, `ConditionValue3`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `conditions` WHERE `SourceTypeOrReferenceId`=4 AND `SourceGroup`=17280 AND `SourceEntry` IN (19803, 19805, 19806, 19807, 19808);\nDELETE FROM `conditions` WHERE `SourceTypeOrReferenceId`=4 AND `SourceGroup` IN (25662, 25663, 25664, 25665, 25668, 25669, 25670, 25671, 25673, 25674) AND `SourceEntry`=50289;\nDELETE FROM `conditions` WHERE `SourceTypeOrReferenceId`=10 AND `SourceGroup` IN (11019, 11020, 11021, 11022) AND `SourceEntry`=50289;\nDELETE FROM `conditions` WHERE `SourceTypeOrReferenceId`=10 AND `SourceGroup`=11150;\nDELETE FROM `conditions` WHERE `SourceTypeOrReferenceId`=1 AND `SourceEntry` IN (17008, 18422, 18423, 21103, 21104, 21105, 21108, 21110, 49205, 49643, 49644);'
    ],
    [
        'creature',
        0,
        'Comment', '`guid`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `creature` WHERE `guid` IN (17669, 28481, 28485, 28486, 28487, 28488, 28489, 28490, 31901, 33823, 33831, 34102, 34103, 34104, 34105, 34106, 34137, 34138, 34139, 38296, 38297, 38298, 38299, 38301, 38302, 38305, 39019, 39020, 39022, 39023, 39024, 39025, 39026, 41884, 41887, 41888, 41889, 41890, 41891, 41892, 41956, 41960, 41961, 41964, 65613, 79011, 79264, 79265, 79266, 79267, 92890, 96656, 96657, 96658, 203492, 203493, 203494, 203495, 246906, 246907, 246910, 246911, 246912, 246913, 246914);\nDELETE FROM `creature` WHERE `id1` IN (1747, 1748, 1749, 1756, 2941, 3083, 3305, 4314, 6109, 8196, 8197, 8198, 10378, 10583, 11036, 11099, 12239, 12397, 12779, 12780, 12786, 12787, 12789, 12790, 12791, 12797, 12798, 13217, 13219, 13697, 13776, 13777, 13816, 13817, 13839, 13840, 13841, 13842, 13843, 14284, 14285, 14304, 14373, 14387, 14622, 14624, 14625, 14626, 14627, 14628, 14634, 14637, 14721, 14730, 14731, 14734, 14736, 14737, 14738, 14739, 14740, 14741, 14743, 14875, 14876, 14887, 14888, 14889, 14890, 14902, 14903, 14904, 14905, 14910, 14911, 14912, 14921, 15070, 15076, 15080, 15165, 15170, 15171, 15172, 15174, 15175, 15176, 15177, 15178, 15179, 15180, 15181, 15182, 15183, 15184, 15185, 15187, 15188, 15189, 15190, 15191, 15192, 15270, 15282, 15306, 15350, 15351, 15419, 15440, 15441, 15442, 15443, 15444, 15481, 15498, 15499, 15500, 15540, 15612, 15613, 15614, 15615, 15616, 15617, 15659, 15675, 15676, 15677, 15678, 15679, 15681, 15682, 15683, 15684, 15686, 15693, 15722, 15903, 16012, 16013, 16091, 16112, 16113, 16114, 16115, 16116, 16131, 16132, 16133, 16134, 16135, 16212, 16225, 16226, 16227, 16256, 16283, 16284, 16287, 16288, 16376, 16378, 16392, 16543, 16840, 16841, 17068, 17069, 17070, 17072, 17079, 17080, 17081, 17082, 17092, 17093, 17094, 17095, 17097, 17098, 17099, 17100, 17103, 17104, 17105, 17106, 17108, 17109, 17119, 17127, 17218, 17223, 17238, 17249, 17291, 17303, 17406, 17409, 17412, 17531, 17541, 17598, 17613, 17765, 17766, 18165, 18221, 18253, 18255, 19202, 19254, 19848, 19850, 19855, 19860, 19905, 19906, 19907, 19908, 19909, 19910, 20406, 20407, 20797, 21045, 21448, 22931, 22935, 22936, 23090, 23127, 23128, 23131, 23449, 23534, 23535, 23536, 23567, 23570, 23571, 23572, 23573, 23579, 23612, 23636, 23797, 23995, 24208, 24366, 24369, 24370, 24410, 24437, 24456, 24729, 24833, 24834, 24835, 24836, 24837, 24838, 24839, 24840, 24841, 24842, 24843, 24851, 24854, 24924, 24926, 24927, 24929, 24930, 24931, 24932, 24934, 24935, 24993, 24995, 24996, 24997, 25007, 25009, 25010, 25011, 25012, 25013, 25014, 25015, 25016, 25017, 25018, 25019, 25020, 25021, 25022, 25023, 25024, 25025, 25070, 25071, 25072, 25074, 25076, 25077, 25079, 25080, 25081, 25083, 25134, 25135, 25136, 25137, 25138, 25140, 25141, 25142, 25143, 25153, 25155, 25167, 25171, 25885, 26537, 26539, 26548, 27666, 27667, 27703, 27705, 28092, 28126, 28601, 28602, 29093, 29095, 29141, 29142, 29143, 29287, 29288, 29289, 29290, 29291, 29292, 29293, 29294, 29295, 29296, 29297, 29298, 29299, 29300, 29346, 29611, 29725, 29728, 30706, 30709, 30710, 30711, 30713, 30715, 30716, 30717, 30721, 30722, 30723, 30724, 30727, 30729, 30730, 30731, 30732, 30733, 30734, 30735, 31144, 31146, 32666, 32667, 33211, 33224, 33303, 33608, 33609, 33610, 33611, 33612, 33613, 33614, 33615, 33616, 33617, 33618, 33619, 33621, 33623, 33638, 33679, 33963, 33964, 33993, 34015, 34043, 34081, 34244, 34765, 34771, 34772, 34788, 34794, 34880, 34881, 34885, 34912, 34914, 34955, 34976, 34978, 34988, 34991, 34997, 34998, 35007, 35008, 35013, 35068, 35073, 35093, 35099, 35100, 35101, 35143, 35281, 35364, 35365, 35469, 35470, 35471, 35472, 35473, 35482, 35483, 35494, 35495, 35499, 35501, 35573, 35574, 35575, 35576, 35577, 35578, 35579, 35580, 35587, 35594, 35596, 35597, 35598, 35599, 35600, 35601, 35602, 35603, 35607, 35611, 35612, 35790, 36065, 36066, 36101, 36102, 36217, 36224, 36225, 36479, 36481, 36506, 36517, 36669, 36670, 37776, 37780, 37888, 37915, 37941, 37942, 37965, 37967, 37968, 38433, 38482, 38493, 39263, 39275, 39349, 39368, 39386, 39396, 39675, 39711, 39715, 39716, 39717, 40160);'
    ],
    [
        'creature_addon',
        0,
        'auras',
        '`guid`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `creature_addon` WHERE `guid` IN (280, 281, 282, 283, 284, 285, 286, 287, 288, 309, 310, 311, 312, 314, 366, 386, 391, 436, 565, 569, 570, 703, 720, 2723, 2724, 2725, 3328, 3371, 3372, 3373, 3374, 3375, 3376, 3377, 3378, 3379, 3380, 3955, 3956, 3957, 4200, 4256, 5584, 5585, 5586, 5587, 5588, 5589, 5596, 5597, 6491, 6503, 6504, 6505, 6506, 6548, 6549, 6550, 6551, 6552, 6553, 6554, 6555, 6556, 6557, 6867, 7393, 7394, 7395, 7396, 8505, 10527, 10528, 11215, 11271, 13981, 14323, 15033, 15540, 15576, 15577, 15702, 15703, 15705, 15938, 16571, 16574, 16575, 16576, 16577, 16578, 16579, 16583, 16584, 16585, 16586, 16587, 16588, 16589, 16590, 16591, 16592, 16593, 16594, 16595, 16596, 16597, 16598, 16599, 16603, 16604, 16605, 16606, 16608, 16609, 16610, 16611, 16989, 16990, 16991, 17315, 17631, 17669, 18580, 18596, 18600, 18601, 20428, 20943, 20945, 20946, 21699, 21773, 21774, 21775, 22788, 23098, 23279, 23281, 23419, 23723, 24051, 24679, 24680, 24681, 24682, 24683, 24684, 26901, 28481, 28485, 28486, 28487, 28488, 28489, 28490, 29063, 29114, 30449, 31901, 32054, 32055, 32058, 32060, 32061, 32062, 32063, 32064, 32066, 32069, 32075, 32101, 32325, 32327, 32343, 32789, 32859, 32911, 32912, 32915, 33316, 33790, 33823, 33831, 34033, 34040, 34102, 34103, 34104, 34105, 34106, 34141, 34142, 34182, 35867, 38296, 38297, 38298, 38299, 38301, 38302, 38305, 39019, 39020, 39022, 39023, 39024, 39025, 39026, 39104, 41884, 41887, 41888, 41889, 41890, 41891, 41892, 41956, 41960, 41961, 41964, 42153, 42154, 42155, 42156, 42157, 42749, 42750, 42752, 42753, 42754, 42755, 42756, 42757, 42758, 42759, 42760, 42761, 42762, 42763, 42764, 42765, 42766, 42767, 42768, 42769, 42770, 42771, 42772, 42773, 42774, 42775, 42776, 42777, 42778, 42779, 42780, 42781, 42782, 42783, 42784, 42785, 42868, 42884, 42885, 42886, 42891, 42892, 42895, 42896, 42897, 42898, 42914, 42915, 42916, 42917, 42918, 43044, 43121, 43122, 43123, 43173, 43175, 43177, 43178, 43180, 43200, 43204, 43205, 43210, 43221, 43236, 45246, 45610, 46167, 46168, 46169, 46170, 46240, 46243, 47640, 48316, 48317, 48318, 48319, 48320, 48321, 48322, 48323, 48324, 48325, 48326, 48327, 48334, 48335, 48336, 48337, 48338, 48339, 48340, 48341, 48342, 49580, 49584, 49588, 49649, 50010, 50012, 50014, 52011, 52013, 52014, 52015, 52016, 52017, 52018, 52020, 52349, 52956, 52958, 53865, 53866, 53867, 53897, 53898, 54120, 54145, 54163, 54164, 54186, 54188, 54190, 54192, 54193, 54765, 54766, 54768, 54805, 54807, 65523, 66479, 81016, 84753, 84987, 84988, 85094, 85117, 85120, 85123, 85124, 85125, 85126, 85127, 85128, 85129, 85135, 85159, 85160, 85161, 85162, 85171, 85173, 85174, 85200, 85214, 85216, 85217, 85224, 85238, 86928, 86929, 88164, 88165, 88166, 88213, 88214, 88215, 88216, 88223, 88224, 88227, 88777, 88794, 88796, 88798, 88799, 92884, 92885, 92889, 92891, 92892, 92893, 92894, 92895, 92896, 92897, 92898, 92899, 92900, 92901, 92902, 92903, 92904, 92905, 92906, 92907, 92908, 92909, 92910, 92911, 92912, 92913, 92914, 92942, 92943, 92944, 92945, 92946, 92983, 96270, 96594, 96619, 97112, 101236, 120602, 133649, 133918, 133921, 133925, 133930, 133931, 137701, 137702, 156950, 200150, 200151, 200152, 201235, 201236, 201237, 201239, 201241, 201242, 202595, 202598, 202605, 202726, 202727, 202730, 202731, 202846, 202958, 202959, 202960, 202961, 202962, 202963, 202964, 202965, 202966, 202967, 202968, 203394, 203420, 204942, 204943, 204944, 204945, 204946, 204947, 204948, 207194, 207195, 207196, 209102, 209103, 209104, 209105, 246904, 246905, 246915, 5300000, 5300001, 5300002, 5300003);'
    ],
    [
        'creature_formations',
        0,
        'point_2',
        '`memberGUID`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `creature_formations` WHERE `leaderGUID` IN (88777, 92903, 246905, 246915, 5300002);'
    ],
    [
        'creature_loot_template',
        0,
        'Comment',
        '`Entry`, `Item`, `Reference`, `GroupId`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `creature_loot_template` WHERE `Entry`=10184;\nDELETE FROM `creature_loot_template` WHERE `Entry`=31311 AND `Reference`=34349;\nDELETE FROM `creature_loot_template` WHERE `Item` IN (17008, 17413, 17414, 17682, 17683, 18600, 18665, 18705, 18987, 21103, 21104, 21105, 21108, 21110, 21877, 27859, 27860, 31952, 49205);\nDELETE FROM `creature_loot_template` WHERE `Item` IN (40752, 40753, 45624, 47241) AND `Entry` IN (15928, 15931, 15932, 15936, 15952, 15953, 15954, 15956, 15989, 15990, 16011, 16028, 16060, 16061, 28860, 29249, 29268, 29278, 29324, 29373, 29417, 29448, 29615, 29701, 29718, 29932, 29940, 29955, 29991, 30061, 30397, 30398, 30510, 30529, 30530, 30532, 30540, 30748, 30774, 30788, 30807, 30810, 31125, 31211, 31212, 31215, 31311, 31349, 31350, 31360, 31362, 31367, 31368, 31370, 31381, 31384, 31386, 31456, 31463, 31464, 31465, 31469, 31506, 31507, 31508, 31509, 31510, 31511, 31512, 31533, 31536, 31537, 31538, 31558, 31559, 31560, 31610, 31611, 31612, 31656, 31673, 31679, 31722, 32313, 32857, 32867, 32927, 33118, 33186, 33190, 33271, 33288, 33293, 33449, 33515, 33692, 33693, 33694, 33724, 33885, 33955, 33993, 33994, 34175, 35013, 35360, 35490, 36538);'
    ],
    [
        'creature_onkill_reputation',
        1,
        'creature_id',
        '`creature_id`, `Patch`',
        'DELETE FROM `creature_onkill_reputation` WHERE `creature_id` IN (1783, 1784, 1785, 1787, 1788, 1789, 1791, 1793, 1794, 1795, 1796, 1802, 1804, 1805, 1847, 1852, 2496, 2625, 2636, 2778, 4472, 4474, 4475, 4624, 4638, 4639, 4640, 4641, 4642, 4643, 4644, 4645, 4646, 4647, 4648, 4649, 4651, 4652, 4653, 4661, 4662, 5601, 5602, 6068, 7153, 7154, 7155, 7156, 7157, 7158, 7438, 7439, 7440, 7441, 7442, 8123, 8523, 8524, 8525, 8526, 8527, 8528, 8529, 8530, 8531, 8532, 8534, 8535, 8538, 8539, 8540, 8541, 8542, 8543, 8544, 8545, 8546, 8547, 8548, 8550, 8551, 8553, 8555, 8556, 8557, 8558, 9462, 9464, 10199, 10381, 10382, 10384, 10385, 10390, 10391, 10398, 10399, 10400, 10405, 10406, 10407, 10408, 10409, 10412, 10413, 10414, 10416, 10417, 10432, 10433, 10435, 10436, 10437, 10438, 10440, 10463, 10464, 10469, 10470, 10471, 10476, 10477, 10478, 10480, 10481, 10482, 10485, 10486, 10487, 10488, 10489, 10491, 10495, 10498, 10499, 10500, 10502, 10503, 10504, 10505, 10507, 10508, 10558, 10580, 10698, 10738, 10801, 10809, 10816, 10821, 10825, 10826, 10827, 10901, 10916, 11082, 11257, 11261, 11338, 11339, 11340, 11350, 11351, 11352, 11353, 11356, 11359, 11361, 11365, 11370, 11371, 11372, 11373, 11374, 11551, 11582, 11622, 11803, 11804, 11830, 11831, 11873, 11880, 11881, 11882, 11883, 12262, 12263, 14342, 14479, 14532, 14750, 14821, 14825, 14861, 14880, 14882, 14883, 15043, 15111, 15168, 15200, 15201, 15202, 15204, 15205, 15206, 15207, 15208, 15209, 15211, 15212, 15213, 15220, 15229, 15230, 15235, 15236, 15240, 15249, 15262, 15264, 15277, 15305, 15307, 15308, 15318, 15319, 15320, 15323, 15324, 15325, 15327, 15333, 15335, 15336, 15338, 15339, 15340, 15348, 15355, 15369, 15370, 15461, 15462, 15537, 15538, 15541, 15542, 15623, 15727, 16184);'
    ],
    [
        'creature_questender',
        0,
        'quest',
        '`id`, `quest`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `creature_questender` WHERE `id` IN (20735, 31439);\nDELETE FROM `creature_questender` WHERE `quest` IN (550, 1661, 3631, 4487, 4488, 4489, 4490, 7028, 7029, 7041, 7044, 7064, 7065, 7066, 7067, 7068, 7070, 7441, 7481, 7482, 7490, 7491, 7492, 7494, 7495, 7496, 7562, 7638, 7670, 8194, 8922, 8923, 10955, 11130, 11172, 11211, 11214, 11215, 11481, 11482, 11497, 11498, 11880, 13830, 13832, 13833, 13834, 13836, 13861, 13862, 13863, 13864, 14016, 14100, 14111);'
    ],
    [
        'creature_queststarter',
        0,
        'quest',
        '`id`, `quest`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `creature_queststarter` WHERE `id` IN (20735, 31439);\nDELETE FROM `creature_queststarter` WHERE `quest` IN (550, 1661, 3631, 4487, 4488, 4489, 4490, 7028, 7029, 7041, 7044, 7064, 7065, 7066, 7067, 7068, 7070, 7441, 7481, 7482, 7491, 7492, 7494, 7496, 7562, 7638, 7670, 8194, 8922, 8923, 10955, 11130, 11172, 11211, 11214, 11215, 11481, 11482, 11497, 11498, 11880, 13830, 13832, 13833, 13834, 13836, 13861, 13862, 13863, 13864, 14016, 14100, 14111);'
    ],
    [
        'creature_template',
        1,
        'difficulty_entry_3',
        '`entry`, `Patch`',
        'DELETE FROM `creature_template` WHERE `entry` IN (38, 68, 103, 352, 466, 523, 594, 596, 619, 706, 853, 866, 931, 946, 1063, 1064, 1387, 1505, 1506, 1507, 1571, 1572, 1573, 1642, 1667, 1688, 1736, 1737, 1739, 1741, 1747, 1748, 1756, 1852, 1892, 1893, 1896, 1976, 1986, 1994, 2106, 2226, 2299, 2389, 2409, 2425, 2432, 2784, 2835, 2851, 2858, 2859, 2861, 2941, 2952, 2953, 2954, 2966, 2995, 3057, 3083, 3084, 3101, 3102, 3183, 3210, 3211, 3213, 3214, 3296, 3305, 3310, 3529, 3531, 3533, 3571, 3615, 3630, 3631, 3632, 3633, 3634, 3638, 3641, 3838, 3841, 4262, 4267, 4280, 4281, 4282, 4283, 4284, 4285, 4312, 4314, 4317, 4319, 4321, 4407, 4423, 4551, 4624, 4788, 4789, 4802, 4803, 4844, 4845, 4846, 4851, 4856, 4872, 4949, 5224, 5225, 5235, 5243, 5261, 5263, 5269, 5546, 5547, 5595, 5624, 5645, 5646, 5647, 5952, 6026, 6132, 6208, 6210, 6213, 6231, 6706, 6726, 7370, 7823, 7824, 7865, 7872, 7873, 7874, 7937, 7939, 7975, 7980, 7999, 8018, 8019, 8020, 8147, 8155, 8383, 8554, 8609, 8610, 9043, 9044, 9460, 10181, 10184, 10378, 10508, 10540, 10583, 10897, 11138, 11139, 11190, 11194, 11262, 11440, 11442, 11443, 11777, 11781, 11782, 11785, 11786, 11787, 11788, 11899, 11900, 11901, 12129, 12160, 12338, 12377, 12378, 12379, 12380, 12397, 12577, 12578, 12596, 12616, 12617, 12636, 12740, 12865, 13177, 13839, 14304, 14363, 14365, 14367, 14375, 14376, 14377, 14378, 14379, 14380, 14423, 14438, 14439, 14440, 14441, 14730, 15177, 15178, 15184, 15350, 15351, 16096, 16222, 16227, 16378, 16733, 16802, 17468, 18978, 20672, 20674, 24456, 24818, 24819, 24841, 24842, 24996, 24997, 24998, 25007, 25021, 25022, 25023, 25024, 25079, 25080, 25081, 25083, 29016, 29019, 29088, 29144, 29152, 29154, 29611, 29712, 31439, 36224, 36225, 36226, 36273);'
    ],
    [
        'creature_text',
        0,
        'comment',
        '`CreatureID`, `GroupID`, `ID`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `creature_text` WHERE `CreatureID`=12397;'
    ],
    [
        'disables',
        0,
        'comment',
        '`sourceType`, `entry`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `disables` WHERE `sourceType`=1 AND `entry` IN (550, 3631, 4487, 4488, 4489, 4490, 6145, 6521, 6522);\nDELETE FROM `disables` WHERE `sourceType`=2 AND `entry` IN (269, 309, 349, 429, 469, 509, 531, 532, 533, 534, 540, 542, 543, 544, 545, 546, 547, 548, 550, 552, 553, 554, 555, 556, 557, 558, 560, 564, 565, 568, 574, 575, 576, 578, 580, 585, 595, 599, 600, 601, 602, 603, 604, 608, 615, 616, 619, 624, 631, 632, 649, 650, 658, 668, 724);\nDELETE FROM `disables` WHERE `sourceType`=3 AND `entry` IN (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 30, 32);\nDELETE FROM `disables` WHERE `sourceType`=5 AND `entry` IN (1, 2, 3, 4, 5, 6, 7);\nDELETE FROM `disables` WHERE `sourceType`=9 AND `entry` IN (1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 18, 19, 20, 21, 23, 24, 26, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 70, 71, 76, 77, 90);'
    ],
    [
        'disenchant_loot_template',
        0,
        'Comment',
        '`Entry`, `Item`, `MinPatch`, `MaxPatch`',
        ''
    ],
    [
        'dungeon_access_requirements',
        0,
        'comment',
        '`dungeon_access_id`, `requirement_type`, `requirement_id`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `dungeon_access_requirements` WHERE `dungeon_access_id` IN (29, 32, 64);'
    ],
    [
        'dungeon_access_template',
        0,
        'comment',
        '`id`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `dungeon_access_template` WHERE `map_id` IN (249, 533);'
    ],
    [
        'fishing_loot_template',
        0,
        'Comment', '`Entry`, `Item`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `fishing_loot_template` WHERE `Reference`=11150;'
    ],
    [
        'gameobject',
        0,
        'Comment',
        '`guid`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `gameobject` WHERE `guid` IN (6928, 50675, 50676, 50677, 50678, 50679, 50680, 50681, 50682, 50683, 50684, 50685, 50686, 50687, 50688, 50689, 50690, 50691, 50692, 151256, 151257, 151258, 151259, 151260, 151261, 151262, 151263, 151264, 151265, 151266, 151267, 151268, 246083, 246084, 246085, 246086);\nDELETE FROM `gameobject` WHERE `id` IN (164725, 175528, 175529, 175530, 175531, 175532, 175533, 176146, 176147, 176148, 176996, 178824, 178825, 178826, 178827, 178828, 178829, 178831, 178832, 178833, 178834, 178844, 178845, 178884, 179554, 179555, 179584, 179585, 179595, 179596, 179827, 179844, 179846, 179879, 179895, 179896, 179913, 180448, 180451, 180665, 180666, 180667, 180717, 180718, 180913, 181075, 181076, 181077, 181078, 181079, 181080, 181081, 181082, 181130, 181131, 181236, 181257, 181310, 181603, 181617, 181618, 181619, 182560, 183435, 184463, 184503, 185321, 185322, 185433, 185550, 186230, 186231, 186232, 186233, 186251, 186426, 186730, 186731, 187056, 187290, 187291, 187292, 187294, 187295, 187296, 187299, 187329, 187334, 187337, 187365, 187390, 190683, 190684, 190697, 190698, 190699, 190704, 190710, 190711, 190712, 193981, 194213, 194237, 194498, 195141, 195142, 195213, 195214, 195218, 195467, 195498, 195528, 195529, 195530, 195554, 195555, 195556, 195557, 195558, 195559, 195560, 195561, 195562, 195603, 195604, 195605, 195606, 195607, 195608, 195609, 195610, 195611, 195612, 195613, 195614, 195615, 195616, 195617, 195618, 195619, 195620, 195624, 195625, 195626, 195627, 195628, 195695, 202184, 202277, 202278, 202713);'
    ],
    [
        'gameobject_loot_template',
        0,
        'Comment',
        '`Entry`, `Item`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `gameobject_loot_template` WHERE `Item` IN (18646, 19803, 19805, 19806, 19807, 19808, 21877, 27859, 27860, 50289);\nDELETE FROM `gameobject_loot_template` WHERE `Item` IN (40752, 40753, 45624, 47241) AND `Entry` IN (24524, 24589, 25192, 25193, 26094, 26097, 26260, 26929, 26946, 26955, 26956, 26959, 26960, 26961, 26962, 26963, 26967, 26974, 27030, 27061, 27068, 27073, 27074, 27078, 27079, 27080, 27081, 27085, 27086, 27414, 27416, 27417);'
    ],
    [
        'gameobject_questender',
        0,
        'quest',
        '`id`, `quest`, `MinPatch`, `MaxPatch`',
        ''
    ],
    [
        'gameobject_queststarter',
        0,
        'quest',
        '`id`, `quest`, `MinPatch`, `MaxPatch`',
        ''
    ],
    [
        'gameobject_template_addon',
        1,
        'entry',
        '`entry`, `Patch`',
        'DELETE FROM `gameobject_template_addon` WHERE `entry` IN (176146, 176147, 176148, 176996);'
    ],
    [
        'gossip_menu_option',
        0,
        'VerifiedBuild',
        '`MenuID`, `OptionID`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `gossip_menu_option` WHERE (`MenuID`=421 AND `OptionID`=8) OR (`MenuID`=435 AND `OptionID`=12) OR (`MenuID`=751 AND `OptionID`=7) OR (`MenuID`=1942 AND `OptionID`=8) OR (`MenuID`=1951 AND `OptionID` IN (11, 14)) OR (`MenuID`=2121 AND `OptionID`=10) OR (`MenuID`=2168 AND `OptionID`=8) OR (`MenuID`=2351 AND `OptionID`=6) OR (`MenuID`=2352 AND `OptionID`=11) OR (`MenuID`=3284 AND `OptionID`=8) OR (`MenuID`=3330 AND `OptionID`=7) OR (`MenuID`=3355 AND `OptionID`=8) OR (`MenuID`=3532 AND `OptionID`=8) OR (`MenuID`=3558 AND `OptionID`=8) OR (`MenuID`=3572 AND `OptionID`=6) OR (`MenuID`=7667 AND `OptionID`=8) OR (`MenuID`=7788 AND `OptionID`=7) OR (`MenuID`=8138 AND `OptionID`=8) OR (`MenuID`=8205 AND `OptionID`=8) OR (`MenuID`=10056 AND `OptionID`=11) OR (`MenuID`=10078 AND `OptionID`=8) OR (`MenuID`=10265 AND `OptionID`=11) OR (`MenuID`=10767 AND `OptionID`=8) OR (`MenuID`=10769 AND `OptionID`=2);\nDELETE FROM `gossip_menu_option` WHERE (`MenuID`=401 AND `OptionID`=6) OR (`MenuID`=1949 AND `OptionID`=7) OR (`MenuID`=2144 AND `OptionID`=7) OR (`MenuID`=3354 AND `OptionID`=1) OR (`MenuID`=3519 AND `OptionID`=6) OR (`MenuID`=10768 AND `OptionID`=1);'
    ],
    [
        'item_loot_template',
        0,
        'Comment',
        '`Entry`, `Item`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `item_loot_template` WHERE `Item` IN (40752, 40753, 45624, 47241) AND `Entry` IN (43346, 43347, 45875, 45878);\nDELETE FROM `item_loot_template` WHERE `Item`=49426 AND `Entry` IN (54516, 54535, 54536);'
    ],
    [
        'item_template',
        1,
        'entry',
        '`entry`, `Patch`',
        'DELETE FROM `item_template` WHERE `entry` IN (1132, 2411, 2414, 5655, 5656, 5665, 5668, 5864, 5872, 5873, 8563, 8588, 8591, 8592, 8595, 8629, 8631, 8632, 13086, 13321, 13322, 13331, 13332, 13333, 13334, 13335, 15277, 15290, 17008, 18241, 18242, 18243, 18244, 18766, 18767, 18772, 18773, 18774, 18776, 18777, 18778, 18785, 18786, 18787, 18788, 18789, 18790, 18791, 18793, 18794, 18795, 18796, 18797, 18798, 18902, 19029, 19030, 19872, 19902, 21218, 21321, 21323, 21324, 25470, 25471, 25472, 25473, 25474, 25475, 25476, 25477, 25527, 25528, 25529, 25531, 25532, 25533, 28481, 28915, 28927, 28936, 29102, 29103, 29104, 29105, 29220, 29221, 29222, 29223, 29224, 29227, 29228, 29229, 29230, 29231, 29465, 29466, 29467, 29468, 29469, 29470, 29471, 29472, 29743, 29744, 29745, 29746, 29747, 30480, 30622, 30623, 30633, 30634, 30635, 30637, 31829, 31830, 31831, 31832, 31833, 31834, 31835, 31836, 32768, 33976, 33977, 34129, 35513, 35906, 40775, 43956, 43958, 43959, 43961, 44077, 44080, 44083, 44086, 44225, 44226, 44230, 44231, 44234, 44235, 46099, 46100, 46308, 47100, 47101);'
    ],
    [
        'mail_level_reward',
        1,
        'senderEntry',
        '`level`, `raceMask`, `Patch`',
        'DELETE FROM `mail_level_reward`;'
    ],
    [
        'mail_loot_template',
        0,
        'Comment',
        '`Entry`, `Item`, `MinPatch`, `MaxPatch`',
        ''
    ],
    [
        'milling_loot_template',
        0,
        'Comment',
        '`Entry`, `Item`, `MinPatch`, `MaxPatch`',
        ''
    ],
    [
        'npc_trainer',
        0,
        'ReqSpell',
        '`ID`, `SpellID`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `npc_trainer` WHERE `SpellID` IN (66, 469, 1710, 2048, 2062, 2825, 2894, 3411, 3714, 3738, 5938, 10847, 13820, 18249, 21562, 21564, 21849, 21850, 22570, 23028, 23161, 23214, 23920, 24248, 24398, 25202, 25203, 25208, 25210, 25213, 25217, 25218, 25221, 25222, 25231, 25233, 25234, 25235, 25236, 25241, 25242, 25248, 25258, 25264, 25269, 25306, 25307, 25308, 25312, 25331, 25363, 25364, 25367, 25368, 25372, 25375, 25384, 25387, 25389, 25391, 25392, 25396, 25420, 25422, 25423, 25431, 25433, 25435, 25437, 25439, 25442, 25448, 25449, 25454, 25457, 25464, 25467, 25469, 25472, 25489, 25500, 25505, 25508, 25509, 25525, 25528, 25533, 25546, 25547, 25552, 25557, 25560, 25563, 25567, 25570, 25574, 25590, 25782, 25894, 25898, 25899, 25916, 25918, 26679, 26746, 26764, 26765, 26770, 26771, 26772, 26839, 26861, 26862, 26863, 26864, 26865, 26867, 26884, 26889, 26916, 26978, 26979, 26980, 26981, 26982, 26983, 26984, 26985, 26986, 26987, 26988, 26989, 26990, 26991, 26992, 26994, 26995, 26996, 26997, 26998, 27000, 27001, 27002, 27003, 27004, 27005, 27006, 27008, 27009, 27012, 27013, 27014, 27016, 27019, 27021, 27022, 27023, 27025, 27033, 27044, 27045, 27046, 27065, 27067, 27068, 27070, 27071, 27072, 27073, 27074, 27075, 27078, 27079, 27080, 27082, 27085, 27086, 27087, 27088, 27090, 27101, 27124, 27125, 27126, 27127, 27128, 27130, 27131, 27132, 27133, 27134, 27135, 27136, 27137, 27138, 27139, 27140, 27141, 27142, 27143, 27149, 27150, 27151, 27152, 27153, 27154, 27173, 27174, 27179, 27180, 27209, 27210, 27211, 27212, 27213, 27215, 27216, 27217, 27218, 27219, 27220, 27222, 27223, 27224, 27228, 27230, 27238, 27243, 27250, 27259, 27260, 27263, 27265, 27441, 27448, 27681, 27683, 27899, 27905, 27944, 27957, 27958, 27961, 28027, 28028, 28172, 28176, 28189, 28275, 28544, 28545, 28551, 28905, 28914, 28917, 28936, 28948, 28953, 29358, 29359, 29360, 29361, 29547, 29548, 29549, 29550, 29552, 29553, 29556, 29557, 29558, 29565, 29686, 29707, 29722, 29858, 29893, 30022, 30306, 30307, 30308, 30309, 30311, 30312, 30324, 30330, 30346, 30356, 30357, 30405, 30414, 30449, 30451, 30455, 30459, 30482, 30545, 30546, 30558, 30560, 30563, 30565, 30566, 30568, 30569, 30570, 30574, 30575, 30909, 30910, 31048, 31049, 31050, 31051, 31052, 31224, 31801, 31884, 32182, 32223, 32231, 32284, 32375, 32379, 32455, 32463, 32464, 32465, 32467, 32468, 32469, 32471, 32472, 32473, 32479, 32480, 32481, 32546, 32594, 32645, 32667, 32684, 32700, 32796, 32996, 32999, 33042, 33043, 33072, 33076, 33357, 33388, 33391, 33405, 33691, 33717, 33733, 33736, 33741, 33745, 33763, 33786, 33933, 33938, 33944, 33946, 33950, 33983, 33987, 33990, 33993, 33995, 33996, 34001, 34004, 34026, 34069, 34090, 34091, 34120, 34413, 34433, 34477, 34529, 34530, 34533, 34534, 34535, 34537, 34538, 34540, 34541, 34542, 34543, 34544, 34545, 34546, 34547, 34548, 34590, 34600, 34767, 34768, 34865, 34866, 34917, 34983, 35540, 35575, 35576, 35577, 35580, 35582, 35584, 35585, 35587, 35588, 35589, 35590, 35591, 35717, 36077, 36078, 36079, 36129, 36130, 36131, 36133, 36134, 36135, 36136, 36137, 36256, 36257, 36258, 36259, 36260, 36261, 36262, 36263, 36916, 36936, 36954, 36955, 37420, 38068, 38070, 38692, 38697, 38699, 38704, 39374, 39636, 39638, 39971, 39973, 40120, 40274, 40514, 41307, 41311, 41312, 41314, 41315, 41316, 41317, 41318, 41319, 41320, 41321, 41414, 41415, 41418, 41420, 41429, 42296, 42302, 42305, 42615, 42650, 42832, 42833, 42841, 42842, 42843, 42846, 42858, 42859, 42872, 42873, 42890, 42891, 42894, 42896, 42897, 42913, 42914, 42917, 42920, 42921, 42925, 42926, 42930, 42931, 42939, 42940, 42944, 42945, 42949, 42950, 42955, 42956, 42985, 42995, 43002, 43008, 43010, 43012, 43015, 43017, 43019, 43020, 43023, 43024, 43038, 43039, 43045, 43046, 43987, 44157, 44343, 44344, 44383, 44484, 44488, 44489, 44492, 44500, 44506, 44508, 44509, 44510, 44513, 44528, 44529, 44555, 44582, 44584, 44589, 44592, 44593, 44598, 44614, 44616, 44623, 44629, 44630, 44633, 44635, 44636, 44645, 44770, 44780, 44781, 44970, 45061, 45380, 45463, 45529, 45545, 45549, 45550, 45551, 45552, 45553, 45554, 45560, 45561, 45562, 45563, 45564, 45565, 45566, 45569, 46845, 47280, 47436, 47437, 47439, 47440, 47449, 47450, 47465, 47470, 47471, 47474, 47475, 47485, 47486, 47487, 47488, 47497, 47498, 47501, 47502, 47519, 47520, 47568, 47610, 47766, 47793, 47808, 47809, 47810, 47811, 47812, 47813, 47814, 47815, 47819, 47820, 47823, 47824, 47825, 47826, 47827, 47835, 47836, 47837, 47838, 47841, 47843, 47846, 47847, 47855, 47856, 47857, 47859, 47860, 47863, 47864, 47865, 47867, 47871, 47878, 47884, 47886, 47888, 47889, 47890, 47891, 47892, 47893, 47897, 47900, 48018, 48020, 48040, 48045, 48062, 48063, 48065, 48066, 48067, 48068, 48070, 48071, 48072, 48073, 48074, 48077, 48078, 48086, 48087, 48088, 48089, 48112, 48113, 48119, 48120, 48122, 48123, 48124, 48125, 48126, 48127, 48134, 48135, 48155, 48156, 48157, 48158, 48159, 48160, 48161, 48162, 48168, 48169, 48170, 48171, 48172, 48173, 48265, 48299, 48300, 48377, 48378, 48440, 48441, 48442, 48443, 48446, 48447, 48450, 48451, 48459, 48461, 48462, 48463, 48464, 48465, 48467, 48468, 48469, 48470, 48477, 48479, 48480, 48559, 48560, 48561, 48562, 48563, 48564, 48565, 48566, 48567, 48568, 48569, 48570, 48571, 48572, 48573, 48574, 48575, 48576, 48577, 48578, 48579, 48637, 48638, 48656, 48657, 48658, 48659, 48660, 48663, 48666, 48667, 48668, 48671, 48672, 48673, 48674, 48675, 48676, 48689, 48690, 48691, 48707, 48743, 48781, 48782, 48784, 48785, 48788, 48792, 48800, 48801, 48805, 48806, 48816, 48817, 48818, 48819, 48824, 48825, 48826, 48827, 48931, 48932, 48933, 48934, 48935, 48936, 48937, 48938, 48941, 48942, 48943, 48945, 48947, 48949, 48950, 48951, 48952, 48989, 48990, 48995, 48996, 48998, 48999, 49000, 49001, 49011, 49012, 49020, 49044, 49045, 49047, 49048, 49049, 49050, 49051, 49052, 49055, 49056, 49066, 49067, 49071, 49230, 49231, 49232, 49233, 49235, 49236, 49237, 49238, 49252, 49258, 49270, 49271, 49272, 49273, 49275, 49276, 49277, 49280, 49281, 49283, 49284, 49799, 49800, 49802, 49803, 49892, 49893, 49894, 49895, 49896, 49903, 49904, 49909, 49918, 49919, 49920, 49921, 49923, 49924, 49927, 49928, 49929, 49930, 49936, 49937, 49938, 49939, 49940, 49941, 49999, 50212, 50213, 50299, 50301, 50307, 50309, 50464, 50511, 50602, 50603, 50604, 50610, 50611, 50619, 50620, 50763, 50764, 50936, 50938, 50939, 50940, 50941, 50942, 50943, 50944, 50945, 50946, 50947, 50948, 50949, 50950, 50951, 50952, 50953, 50954, 50955, 50956, 50957, 50958, 50959, 50960, 50961, 50962, 50963, 50964, 50965, 50966, 50967, 51293, 51295, 51298, 51301, 51303, 51308, 51310, 51312, 51326, 51327, 51328, 51409, 51410, 51411, 51417, 51418, 51419, 51423, 51424, 51425, 51505, 51514, 51568, 51569, 51570, 51571, 51572, 51723, 51724, 51993, 51994, 52567, 52568, 52569, 52570, 52571, 52572, 52610, 53005, 53006, 53007, 53023, 53042, 53140, 53142, 53199, 53200, 53201, 53225, 53226, 53248, 53249, 53251, 53271, 53281, 53307, 53308, 53312, 53323, 53338, 53339, 53344, 53351, 53600, 53601, 53736, 53812, 53831, 53832, 53834, 53835, 53836, 53837, 53838, 53839, 53840, 53841, 53842, 53843, 53844, 53845, 53847, 53848, 53852, 53853, 53854, 53855, 53856, 53859, 53860, 53861, 53862, 53863, 53864, 53866, 53867, 53868, 53870, 53871, 53872, 53873, 53874, 53876, 53878, 53880, 53881, 53882, 53883, 53886, 53887, 53889, 53890, 53891, 53892, 53893, 53894, 53898, 53899, 53900, 53901, 53902, 53903, 53905, 53916, 53918, 53920, 53922, 53923, 53925, 53926, 53927, 53928, 53930, 53931, 53934, 53940, 53941, 53947, 53953, 53956, 53969, 53989, 54007, 54017, 54043, 54083, 54197, 54213, 54218, 54353, 54428, 54446, 54550, 54551, 54552, 54553, 54554, 54555, 54556, 54557, 54736, 54793, 54917, 54918, 54941, 54944, 54945, 54946, 54947, 54948, 54949, 54998, 54999, 55002, 55013, 55014, 55015, 55016, 55017, 55055, 55056, 55057, 55058, 55174, 55177, 55179, 55181, 55182, 55183, 55184, 55185, 55186, 55187, 55199, 55200, 55201, 55202, 55203, 55204, 55206, 55208, 55211, 55259, 55260, 55261, 55262, 55265, 55268, 55270, 55271, 55298, 55300, 55301, 55302, 55303, 55304, 55305, 55306, 55307, 55308, 55309, 55310, 55311, 55312, 55342, 55359, 55360, 55369, 55370, 55371, 55372, 55373, 55374, 55375, 55376, 55377, 55386, 55394, 55399, 55402, 55458, 55459, 55628, 55641, 55642, 55656, 55694, 55732, 55769, 55777, 55834, 55835, 55839, 55898, 55899, 55900, 55901, 55902, 55903, 55904, 55906, 55907, 55908, 55910, 55911, 55913, 55914, 55919, 55920, 55921, 55922, 55923, 55924, 55925, 55941, 55943, 55995, 56000, 56001, 56002, 56003, 56007, 56008, 56010, 56014, 56015, 56018, 56019, 56020, 56021, 56022, 56023, 56024, 56025, 56026, 56027, 56028, 56029, 56030, 56031, 56034, 56039, 56193, 56194, 56195, 56196, 56197, 56199, 56201, 56202, 56203, 56205, 56206, 56208, 56222, 56234, 56280, 56349, 56357, 56400, 56459, 56460, 56461, 56462, 56463, 56464, 56465, 56466, 56467, 56468, 56469, 56470, 56471, 56472, 56473, 56474, 56475, 56476, 56477, 56478, 56479, 56480, 56481, 56483, 56484, 56486, 56487, 56514, 56530, 56531, 56549, 56550, 56551, 56552, 56553, 56554, 56555, 56556, 56574, 56815, 56943, 56952, 56972, 56980, 56984, 56987, 56991, 57003, 57006, 57008, 57033, 57036, 57113, 57122, 57168, 57172, 57187, 57192, 57198, 57222, 57224, 57225, 57226, 57227, 57248, 57252, 57257, 57275, 57330, 57425, 57427, 57622, 57623, 57683, 57690, 57691, 57714, 57715, 57716, 57721, 57722, 57755, 57823, 57934, 57946, 57960, 57992, 57993, 58065, 58141, 58142, 58143, 58144, 58145, 58146, 58431, 58434, 58481, 58482, 58483, 58489, 58490, 58491, 58580, 58581, 58582, 58643, 58649, 58652, 58656, 58659, 58699, 58703, 58704, 58731, 58734, 58737, 58739, 58741, 58745, 58746, 58749, 58751, 58753, 58755, 58756, 58757, 58771, 58773, 58774, 58785, 58789, 58790, 58794, 58795, 58796, 58801, 58803, 58804, 58868, 58871, 58887, 59092, 59156, 59158, 59159, 59161, 59163, 59164, 59170, 59171, 59172, 59338, 59339, 59340, 59405, 59406, 59436, 59438, 59440, 59441, 59442, 59495, 59496, 59497, 59498, 59500, 59501, 59503, 59504, 59582, 59583, 59584, 59585, 59586, 59587, 59588, 59589, 59636, 59759, 60043, 60051, 60052, 60053, 60192, 60219, 60220, 60337, 60350, 60367, 60396, 60403, 60405, 60583, 60584, 60599, 60600, 60601, 60604, 60605, 60606, 60607, 60608, 60609, 60611, 60613, 60616, 60619, 60620, 60621, 60622, 60623, 60624, 60627, 60629, 60630, 60631, 60637, 60640, 60643, 60649, 60651, 60652, 60653, 60655, 60658, 60660, 60663, 60665, 60666, 60668, 60669, 60671, 60874, 60893, 60971, 60990, 60993, 60994, 61005, 61006, 61008, 61009, 61010, 61117, 61118, 61119, 61120, 61177, 61191, 61290, 61299, 61300, 61301, 61384, 61411, 61464, 61471, 61481, 61482, 61483, 61649, 61657, 61846, 61847, 61999, 62078, 62158, 62162, 62213, 62242, 62271, 62409, 62448, 62757, 62959, 63182, 63669, 63670, 63671, 63672, 63742, 63743, 63746, 63750, 63765, 63770, 64053, 64358, 64382, 64661, 64725, 64726, 64727, 64728, 64729, 64730, 64843, 64901, 66658, 66660, 66662, 66663, 66664, 66842, 66843, 66844, 67025, 67326, 67839, 67920, 69385, 69386, 69388, 69412, 70164);'
    ],
    [
        'npc_vendor',
        0,
        'VerifiedBuild',
        '`entry`, `item`, `ExtendedCost`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `npc_vendor` WHERE (`item` IN (16083, 16084, 17020, 17021, 17026, 17028, 17029, 21177, 22147, 22148, 27855, 27856, 27859, 28053, 28060, 28399, 29267, 29268, 29269, 29270, 29272, 29273, 29274, 29275, 29367, 29368, 29370, 29373, 29374, 29375, 29379, 29381, 29383, 29384, 29386, 29387, 29389, 30761, 30762, 30763, 30764, 30766, 30767, 30768, 30769, 30770, 30772, 30773, 30774, 30776, 30778, 30779, 30780, 32083, 32084, 32085, 32086, 32087, 32088, 32089, 32090, 33192, 33207, 33279, 33280, 33287, 33291, 33296, 33304, 33324, 33325, 33331, 33333, 33334, 33386, 33444, 33445, 33449, 33452, 33454, 33484, 33501, 33502, 33503, 33504, 33505, 33506, 33507, 33510, 33512, 33513, 33514, 33515, 33516, 33517, 33518, 33519, 33520, 33522, 33523, 33524, 33527, 33528, 33529, 33530, 33531, 33532, 33534, 33535, 33536, 33537, 33538, 33539, 33540, 33552, 33557, 33559, 33566, 33578, 33579, 33580, 33582, 33583, 33584, 33585, 33586, 33587, 33588, 33589, 33593, 33810, 33832, 33965, 33970, 33972, 33974, 34049, 34050, 34162, 34163, 34581, 34582, 35321, 35324, 35326, 35947, 35948, 35949, 35950, 35953, 35954, 37201, 37915, 38327, 38328, 40411, 44605, 44614, 44615, 45057, 45688, 45689, 45690, 45691, 45774, 45819, 45820, 45821, 45822, 45823, 46349, 47729, 47730, 47731, 47732, 47733, 48677, 48683, 48685, 48687, 48689, 48691, 48718, 48954, 48955, 48956, 48957, 49177, 51557, 51558, 51559, 51560)) OR (`entry`=32216 AND `item` IN (25470, 25471, 25472, 25473, 25474, 25475, 25476, 25477, 25527, 25528, 25529, 25531, 25532, 25533));\nDELETE FROM `npc_vendor` WHERE `entry`=35496 AND `item` IN (50240, 50241, 50242, 50243, 50244, 50275, 50276, 50277, 50278, 50279, 50391, 50392, 50393, 50394, 50396, 50765, 50766, 50767, 50768, 50769, 51155, 51156, 51157, 51158, 51159, 51175, 51176, 51177, 51178, 51179, 51180, 51181, 51182, 51183, 51184, 51205, 51206, 51207, 51208, 51209, 51230, 51231, 51232, 51233, 51234, 51255, 51256, 51257, 51258, 51259, 51260, 51261, 51262, 51263, 51264, 51280, 51281, 51282, 51283, 51284);\nDELETE FROM `npc_vendor` WHERE `entry`=35497 AND `item` IN (50087, 50088, 50089, 50090, 50105, 50106, 50107, 50108, 50109, 50113, 50819, 50820, 50821, 50822, 50823, 50824, 50825, 50826, 50827, 50828, 51135, 51136, 51137, 51138, 51139, 51140, 51141, 51142, 51143, 51144, 51145, 51146, 51147, 51148, 51149, 51185, 51186, 51187, 51188, 51189, 51250, 51251, 51252, 51253, 51254, 51290, 51291, 51292, 51293, 51294, 51295, 51296, 51297, 51298, 51299, 51300, 51301, 51302, 51303, 51304);\nDELETE FROM `npc_vendor` WHERE `entry`=35498 AND `item` IN (50078, 50079, 50080, 50081, 50082, 50094, 50095, 50096, 50097, 50098, 50324, 50325, 50326, 50327, 50328, 50846, 50847, 50848, 50849, 50850, 50853, 50854, 50855, 50856, 50857, 50860, 50861, 50862, 50863, 50864, 50865, 50866, 50867, 50868, 50869, 51125, 51126, 51127, 51128, 51129, 51130, 51131, 51132, 51133, 51134, 51160, 51161, 51162, 51163, 51164, 51165, 51166, 51167, 51168, 51169, 51170, 51171, 51172, 51173, 51174, 51210, 51211, 51212, 51213, 51214, 51215, 51216, 51217, 51218, 51219, 51220, 51221, 51222, 51223, 51224, 51225, 51226, 51227, 51228, 51229, 51265, 51266, 51267, 51268, 51269, 51270, 51271, 51272, 51273, 51274, 51275, 51276, 51277, 51278, 51279, 51305, 51306, 51307, 51308, 51309, 51310, 51311, 51312, 51313, 51314);\nDELETE FROM `npc_vendor` WHERE `entry`=35500 AND `item` IN (50114, 50115, 50116, 50117, 50118, 50830, 50831, 50832, 50833, 50834, 50835, 50836, 50837, 50838, 50839, 50841, 50842, 50843, 50844, 50845, 51150, 51151, 51152, 51153, 51154, 51190, 51191, 51192, 51193, 51194, 51195, 51196, 51197, 51198, 51199, 51200, 51201, 51202, 51203, 51204, 51235, 51236, 51237, 51238, 51239, 51240, 51241, 51242, 51243, 51244, 51245, 51246, 51247, 51248, 51249, 51285, 51286, 51287, 51288, 51289);\nDELETE FROM `npc_vendor` WHERE `entry`=29538 AND `item` IN (45829, 45830, 45838, 45839, 45846, 45847);\nDELETE FROM `npc_vendor` WHERE `entry`=34252 AND `item` IN (48371, 48372, 48373, 48374, 48375, 48429, 48436, 48445, 48448, 48449, 48472, 48474, 48476, 48478, 48480, 48529, 48531, 48533, 48535, 48537, 48564, 48566, 48568, 48572, 48574, 48602, 48603, 48604, 48605, 48606, 48632, 48633, 48634, 48635, 48636);\nDELETE FROM `npc_vendor` WHERE `entry`=35496 AND `item` IN (47748, 47749, 47750, 47751, 47752, 47773, 47774, 47775, 47776, 47777, 47783, 47784, 47785, 47786, 47787, 47798, 47799, 47800, 47801, 47802, 47914, 47936, 47980, 47981, 47982, 48067, 48068, 48069, 48070, 48071, 48072, 48073, 48074, 48075, 48076, 48097, 48098, 48099, 48100, 48101);\nDELETE FROM `npc_vendor` WHERE `entry`=35497 AND `item` IN (48102, 48129, 48130, 48131, 48132, 48153, 48154, 48155, 48156, 48157, 48158, 48159, 48160, 48161, 48162, 48183, 48184, 48185, 48186, 48187, 48188, 48189, 48190, 48191, 48192, 48213, 48214, 48215, 48216, 48217, 48218, 48219, 48220, 48221, 48222, 48243, 48244, 48245, 48246, 48247);\nDELETE FROM `npc_vendor` WHERE `entry`=35498 AND `item` IN (48386, 48387, 48388, 48389, 48390, 48456, 48457, 48458, 48459, 48460, 48501, 48502, 48503, 48504, 48505, 48558, 48559, 48560, 48561, 48562, 48595, 48596, 48597, 48598, 48599, 48627, 48628, 48629, 48630, 48631, 48652, 48653, 48654, 48655, 48656);\nDELETE FROM `npc_vendor` WHERE `entry`=35500 AND `item` IN (48250, 48251, 48252, 48253, 48254, 48275, 48276, 48277, 48278, 48279, 48280, 48281, 48282, 48283, 48284, 48295, 48296, 48297, 48298, 48299, 48310, 48312, 48313, 48314, 48315, 48336, 48337, 48338, 48339, 48340, 48341, 48342, 48343, 48344, 48345, 48366, 48367, 48368, 48369, 48370);\nDELETE FROM `npc_vendor` WHERE `entry`=28992 AND `item` IN (45345, 45346, 45347, 45348, 45349, 45351, 45352, 45353, 45354, 45355, 45356, 45357, 45358, 45359, 45396, 45397, 45398, 45399, 45400, 45829, 45830, 45838, 45839, 45846, 45847, 46123, 46124, 46125, 46126, 46127, 46157, 46158, 46159, 46160, 46161, 46183, 46184, 46185, 46186, 46187, 46189, 46191, 46192, 46194, 46196, 46313);\nDELETE FROM `npc_vendor` WHERE `entry`=29523 AND `item` IN (45360, 45361, 45362, 45363, 45364, 45401, 45402, 45403, 45404, 45405, 45406, 45408, 45409, 45410, 45411, 45412, 45413, 45414, 45415, 45416, 45827, 45828, 45836, 45837, 45844, 45845, 46141, 46142, 46143, 46144, 46145, 46198, 46199, 46200, 46201, 46202, 46203, 46204, 46205, 46206, 46207, 46208, 46209, 46210, 46211, 46212);\nDELETE FROM `npc_vendor` WHERE `entry`=28995 AND `item` IN (45365, 45367, 45368, 45369, 45386, 45387, 45388, 45389, 45390, 45391, 45392, 45393, 45394, 45395, 45417, 45419, 45420, 45421, 45422, 45831, 45840, 45848, 46129, 46130, 46131, 46132, 46133, 46134, 46135, 46136, 46137, 46139, 46140, 46163, 46165, 46168, 46170, 46172, 46188, 46190, 46193, 46195, 46197);\nDELETE FROM `npc_vendor` WHERE `entry`=28997 AND `item` IN (45824, 45825, 45826, 45833, 45834, 45835, 45841, 45842, 45843);\nDELETE FROM `npc_vendor` WHERE `entry`=34252 AND `item` IN (45335, 45336, 45337, 45338, 45339, 45340, 45341, 45342, 45343, 45344, 45370, 45371, 45372, 45373, 45374, 45375, 45376, 45377, 45379, 45380, 45381, 45382, 45383, 45384, 45385, 45424, 45425, 45426, 45427, 45428, 45429, 45430, 45431, 45432, 45433, 46111, 46113, 46115, 46116, 46117, 46118, 46119, 46120, 46121, 46122, 46146, 46148, 46149, 46150, 46151, 46152, 46153, 46154, 46155, 46156, 46162, 46164, 46166, 46167, 46169, 46173, 46174, 46175, 46176, 46177, 46178, 46179, 46180, 46181, 46182);'
    ],
    [
        'pickpocketing_loot_template',
        0,
        'Comment',
        '`Entry`, `Item`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `pickpocketing_loot_template` WHERE `Item` IN (21877, 27859);'
    ],
    [
        'player_loot_template',
        0,
        'Comment',
        '`Entry`, `Item`, `MinPatch`, `MaxPatch`',
        ''
    ],
    [
        'player_xp_for_level',
        1,
        'Level',
        '`Level`, `Patch`',
        'DELETE FROM `player_xp_for_level` WHERE `Level` BETWEEN 11 AND 69;'
    ],
    [
        'pool_creature',
        0,
        'description',
        '`guid`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `pool_creature` WHERE `pool_entry`=60003;'
    ],
    [
        'pool_quest',
        0,
        'description',
        '`entry`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `pool_quest` WHERE `pool_entry` IN (5676, 5678, 87000);'
    ],
    [
        'pool_template',
        0,
        'description',
        '`entry`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `pool_template` WHERE `entry` IN (5678, 60003, 87000);'
    ],
    [
        'prospecting_loot_template',
        0,
        'Comment',
        '`Entry`, `Item`, `MinPatch`, `MaxPatch`',
        ''
    ],
    [
        'quest_template',
        1,
        'ID',
        '`ID`, `Patch`',
        'DELETE FROM `quest_template` WHERE `ID` IN (6607, 6622, 6624, 13240, 13241, 13243, 13244, 13245, 13246, 13247, 13248, 13249, 13250, 13251, 13252, 13253, 13254, 13255, 13256, 14199, 24788, 24789, 24790);'
    ],
    [
        'reference_loot_template',
        0,
        'Comment',
        '`Entry`, `Item`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `reference_loot_template` WHERE `Entry` BETWEEN 46000 AND 46009;\nDELETE FROM `reference_loot_template` WHERE `Entry`=34349 AND `Item` IN (45624, 47241);\nDELETE FROM `reference_loot_template` WHERE `Entry`=34000;\nDELETE FROM `reference_loot_template` WHERE `Item` IN (17413, 17414, 17682, 17683, 18600, 19803, 19805, 19806, 19807, 19808, 50289);'
    ],
    [
        'skinning_loot_template',
        0,
        'Comment',
        '`Entry`, `Item`, `MinPatch`, `MaxPatch`',
        ''
    ],
    [
        'smart_scripts',
        0,
        'comment',
        '`entryorguid`, `source_type`, `id`, `link`, `MinPatch`, `MaxPatch`',
        'DELETE FROM `smart_scripts` WHERE `entryorguid` IN (-246915, -246904, -209026, -209025, -209024, -209023, -209022, -209021, -209020, -209019, -96612, -96611, -96610, -96604, -96603, -96600, -96596, -96595, -88792, -88791, -88790, -88789, -88788, -88787, -88786, -88785, -88784, -88783, -88782, -88781, -88780, -88779, 1748);'
    ],
    [
        'spell_loot_template',
        0,
        'Comment',
        '`Entry`, `Item`, `MinPatch`, `MaxPatch`',
        ''
    ],
    [
        'transports',
        1,
        'guid',
        '`guid`, `Patch`',
        'DELETE FROM `transports` WHERE `guid` IN (9, 10, 11, 12, 17, 20);'
    ]
]

cwd = os.getcwd()
mysqlcnf = f'{cwd}/mysql.cnf'

os.system('cls' if os.name == 'nt' else 'clear')

file = open(mysqlcnf, 'w')
file.write(f'[client]\nhost="{mysql['host']}"\nport="{mysql['port']}"\nuser="{mysql['username']}"\npassword="{mysql['password']}"')
file.close()

def PrintHeader(string):
    print(f'{colorama.Fore.GREEN}{string}{colorama.Style.RESET_ALL}')

def PrintProgress(string):
    print(f'{colorama.Fore.YELLOW}{string}{colorama.Style.RESET_ALL}')

def PrintError(string):
    print(f'{colorama.Fore.RED}{string}{colorama.Style.RESET_ALL}')
    if os.path.exists(mysqlcnf):
        os.remove(mysqlcnf)
    if os.path.exists(f'{cwd}/export.sql'):
        os.remove(f'{cwd}/export.sql')
    exit()

class GitProgress(git.remote.RemoteProgress):
    def line_dropped(self, line):
        print(line)
    def update(self, *args):
        print(self._cur_line)

def ResetSource(path, branch):
    repo = git.Repo(path)
    repo.git.reset('--hard', f'origin/master')

def CloneSource(path, repo, branch):
    git.Repo.clone_from(url=repo, to_path=path, branch=branch, depth=1, progress=GitProgress())

def PullSource(path):
    repo = git.Repo(path)
    repo.remotes.origin.pull(progress=GitProgress())

def UpdateSource():
    PrintHeader('Updating source')
    if not os.path.exists(f'{cwd}/source'):
        try:
            CloneSource(f'{cwd}/source', 'git@github.com:noisiver/azerothcore', 'master')
        except Exception as e:
            print(e.stderr)
    else:
        try:
            ResetSource(f'{cwd}/source', 'master')
            PullSource(f'{cwd}/source')
        except Exception as e:
            print(e.stderr)
    PrintHeader('Finished updating source')

def DropTables():
    PrintHeader('Dropping tables')
    connect = pymysql.connect(host=mysql['host'], user=mysql['username'], password=mysql['password'], db=mysql['base'])
    cursor = connect.cursor()
    cursor.execute('SHOW TABLES;')
    tables = []
    for d in cursor.fetchall():
        tables.append(d[0])
    if len(tables) > 0:
        for table in tables:
            PrintProgress(f'Dropping {table}')
            cursor.execute(f'DROP TABLE {table};')
        connect.commit()
    cursor.close()
    connect.close()
    PrintHeader('Finished dropping tables')

def ImportTables():
    PrintHeader('Importing tables')
    path = f'{cwd}/source/data/sql/base/db_world'
    if os.path.isdir(path):
        connect = pymysql.connect(host=mysql['host'], user=mysql['username'], password=mysql['password'], db=mysql['base'])
        cursor = connect.cursor()
        cursor.execute('SHOW TABLES;')
        tables = []
        for d in cursor.fetchall():
            tables.append(d[0])
        cursor.close()
        connect.close()

        files = sorted(os.listdir(path))
        for file in files:
            if os.path.isfile(f'{path}/{file}'):
                if file.endswith('.sql'):
                    short = file.replace('.sql', '')
                    if short in tables:
                        PrintProgress(f'Skipping {file}')
                    else:
                        PrintProgress(f'Importing {file}')
                        subprocess.run(f'{f'"{windows_paths['mysql']}/bin/mysql.exe"' if os.name == 'nt' else 'mysql'} --defaults-extra-file={mysqlcnf} {mysql['base']} < {path}/{file}', shell=True, check=True)
    PrintHeader('Finished importing tables')

def sha1sum(filename):
    with open(filename, 'rb', buffering=0) as f:
        return hashlib.file_digest(f, 'sha1').hexdigest()

def ImportUpdates():
    PrintHeader('Importing updates')
    path = f'{cwd}/source/data/sql/updates/db_world'
    if os.path.isdir(path):
        connect = pymysql.connect(host=mysql['host'], user=mysql['username'], password=mysql['password'], db=mysql['base'])
        cursor = connect.cursor()
        cursor.execute('SELECT name, hash FROM updates')
        updates = []
        for d in cursor.fetchall():
            updates.append([d[0], d[1]])

        files = sorted(os.listdir(path))
        for file in files:
            if os.path.isfile(f'{path}/{file}'):
                if file.endswith('.sql'):
                    sha = sha1sum(f'{path}/{file}').upper()
                    adv = [ file, sha ]

                    if adv in updates:
                        PrintProgress(f'Skipping {file}')
                    else:
                        PrintProgress(f'Importing {file}')
                        subprocess.run(f'{f'"{windows_paths['mysql']}/bin/mysql.exe"' if os.name == 'nt' else 'mysql'} --defaults-extra-file={mysqlcnf} {mysql['base']} < {path}/{file}', shell=True, check=True)
                        cursor.execute(f"DELETE FROM updates WHERE name='{file}';")
                        cursor.execute(f"INSERT INTO updates (name, hash) VALUES ('{file}', '{sha}');")
                        connect.commit()

        cursor.close()
        connect.close()
        PrintHeader('Finished importing updates')

def ImportData():
    PrintHeader('Importing base data')

    files = sorted(os.listdir(f'{cwd}/sql'))
    for file in files:
        if os.path.isfile(f'{cwd}/sql/{file}'):
            if file.endswith('.sql'):
                try:
                    PrintProgress(f'Importing {file}')
                    subprocess.run(f'{f'"{windows_paths['mysql']}/bin/mysql.exe"' if os.name == 'nt' else 'mysql'} --defaults-extra-file={mysqlcnf} {mysql['database']} < {cwd}/sql/{file}', shell=True, check=True)
                except:
                    PrintError(f'Failed to import {file}')

    PrintHeader('Finished importing base data')

def GenerateProcedure(table, type, after, primary):
    return f'DELIMITER $$\nDROP PROCEDURE IF EXISTS AddColumn $$\nCREATE PROCEDURE AddColumn()\nBEGIN\n    IF NOT EXISTS((SELECT * FROM information_schema.COLUMNS WHERE TABLE_SCHEMA=DATABASE() AND COLUMN_NAME=\'{'MinPatch' if type == 0 else 'Patch'}\' AND TABLE_NAME=\'{table}\')) THEN\n        ALTER TABLE `{table}`\n            {f'ADD COLUMN `MinPatch` INT UNSIGNED NOT NULL DEFAULT \'0\' AFTER `{after}`,\n            ADD COLUMN `MaxPatch` INT UNSIGNED NOT NULL DEFAULT \'21\' AFTER `MinPatch`,\n' if type == 0 else f'ADD COLUMN `Patch` INT UNSIGNED NOT NULL DEFAULT \'0\' AFTER `{after}`,\n'}            DROP PRIMARY KEY,\n            ADD PRIMARY KEY ({primary}) USING BTREE;\n    END IF;\nEND $$\nCALL AddColumn()\n$$\nDELIMITER ;\nDROP PROCEDURE IF EXISTS AddColumn;'

def CreateBaseFiles():
    PrintHeader('Creating base files')

    if not os.path.isdir(f'{cwd}/export'):
        os.mkdir(f'{cwd}/export', 0o777)

    for table in tables:
        name = table[0]
        type = table[1]
        after = table[2]
        primary = table[3]
        deletes = table[4]

        try:
            data = f'{GenerateProcedure(name, type, after, primary)}\n'
            if deletes:
                data = f'{data}\n{deletes}'

            PrintProgress(f'Creating progression_{name}.sql')
            file = open(f'{cwd}/export/progression_{name}.sql', 'w')
            file.write(data)
            file.close()
        except:
            PrintError(f'Failed to create progression_{name}.sql')

    PrintHeader('Finished creating base files')

def ExportData():
    PrintHeader('Exporting data')

    for table in tables:
        name = table[0]

        try:
            PrintProgress(f'Exporting {name}')
            subprocess.run(f'{f'"{windows_paths['mysql']}/bin/mysqldump.exe"' if os.name == 'nt' else 'mysqldump'} --defaults-extra-file={mysqlcnf} --skip-add-drop-table --no-create-info --skip-comments --complete-insert {mysql['database']} {name} > {cwd}/export.sql', shell=True, check=True)

            with open(f'{cwd}/export.sql', encoding='utf-8') as file:
                lines = file.readlines()

            with open(f'{cwd}/export.sql', 'w', encoding='utf-8') as file:
                for count, line in enumerate(lines):
                    if not line.startswith('/*') and not line.startswith('\n') and not line.startswith('LOCK') and not line.startswith('UNLOCK'):
                        file.write(line)

            with open(f'{cwd}/export.sql', 'r') as file:
                content = file.read()

            content = content.replace('VALUES ', 'VALUES\n').replace('),(', '),\n(').replace(',', ', ').replace(',  ', ', ').replace(', \n', ',\n')

            if len(content) > 0:
                with open(f'{cwd}/export/progression_{name}.sql', 'a') as file:
                    file.write(f'\n{content}')
        except:
            PrintError(f'Failed to export {name}')

    if os.path.exists(f'{cwd}/export.sql'):
        os.remove(f'{cwd}/export.sql')

    PrintHeader('Finished exporting data')

UpdateSource()
DropTables()
ImportTables()
ImportUpdates()
ImportData()
CreateBaseFiles()
ExportData()

if os.path.exists(mysqlcnf):
    os.remove(mysqlcnf)
